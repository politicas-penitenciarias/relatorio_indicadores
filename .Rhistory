pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não aplicável",
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ 0,
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ 0,
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ 0,
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate_if(
is.numeric,
as.character
) |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ 0,
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ 0,
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate_if(
is.numeric,
as.character
) |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "0",
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "0",
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate_if(
is.numeric,
as.character
) |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
# A CAPACIDADE DE MONITORAMENTO ELETRONICO COM PREENHIDO ERRADO PELO ACRE, NESSE SENTIDO TEM
# UMA DIFERENÇA DE 478 TORNEZELEIRAS ELETRONICAS CONTABILIZADAS EM OUTROS REGIMES DIFERENTES DE
# "OUTROS" CONFORME NOTA TECNICA CNISP.
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate_if(
is.numeric,
as.character
) |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
names(t1) <- c("Modalidade","Feminino","Masculino","Total")
formattable::formattable(
t1,
align = c("c","l","l","l"),
list(
#`UF` = color_tile("lightgrey","orange"),
`Modalidade` = color_tile("lightgrey","orange"),
#`Âmbito` = color_tile("lightblue","lightyellow"),
area(col = c(`Feminino`)) ~ normalize_bar("#F6FF98", 0.2),
area(col = c(`Masculino`)) ~ normalize_bar("#F6FF98", 0.2),
area(col = c(`Total`)) ~ normalize_bar("lightblue", 0.2)
)) |>
as.datatable(
extensions = 'Buttons',
escape = FALSE,
#caption = "Tabela: Taxas de ocupação por unidade federativa, tipo de estabelecimento e regime.",
rownames = FALSE,
class='hover cell-border stripe',
filter = "top",
style = "bootstrap4",
options = list(
dom='Bfrtip',
buttons=c('copy', 'csv', 'excel', 'print', 'pdf'),
autoFill = TRUE,
colReorder = TRUE,
pageLength = 27,
lengthMenu = seq(10,max(nrow(t2))+10,10),
language = list(
info = 'Mostrando de _START_ para _END_ em um total de _TOTAL_ registros',
paginate = list(previous = 'Anterior', `next` = 'Seguinte'),
url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Portuguese-Brasil.json'
)
#pageLength = 5
)
)
# A CAPACIDADE DE MONITORAMENTO ELETRONICO COM PREENHIDO ERRADO PELO ACRE, NESSE SENTIDO TEM
# UMA DIFERENÇA DE 478 TORNEZELEIRAS ELETRONICAS CONTABILIZADAS EM OUTROS REGIMES DIFERENTES DE
# "OUTROS" CONFORME NOTA TECNICA CNISP.
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate_if(
is.numeric,
as.character
) |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
names(t1) <- c("Modalidade","Feminino","Masculino","Total")
formattable::formattable(
t1,
align = c("c","l","l","l"),
list(
#`UF` = color_tile("lightgrey","orange"),
`Modalidade` = color_tile("lightgrey","orange"),
#`Âmbito` = color_tile("lightblue","lightyellow"),
Feminino = color_tile("lightgrey","gray"),
Masculino = color_tile("lightgrey","gray"),
Total = color_tile("lightgrey","gray"),
# area(col = c(`Feminino`)) ~ normalize_bar("#F6FF98", 0.2),
# area(col = c(`Masculino`)) ~ normalize_bar("#F6FF98", 0.2),
# area(col = c(`Total`)) ~ normalize_bar("lightblue", 0.2)
)) |>
as.datatable(
extensions = 'Buttons',
escape = FALSE,
#caption = "Tabela: Taxas de ocupação por unidade federativa, tipo de estabelecimento e regime.",
rownames = FALSE,
class='hover cell-border stripe',
filter = "top",
style = "bootstrap4",
options = list(
dom='Bfrtip',
buttons=c('copy', 'csv', 'excel', 'print', 'pdf'),
autoFill = TRUE,
colReorder = TRUE,
pageLength = 27,
lengthMenu = seq(10,max(nrow(t2))+10,10),
language = list(
info = 'Mostrando de _START_ para _END_ em um total de _TOTAL_ registros',
paginate = list(previous = 'Anterior', `next` = 'Seguinte'),
url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Portuguese-Brasil.json'
)
#pageLength = 5
)
)
# A CAPACIDADE DE MONITORAMENTO ELETRONICO COM PREENHIDO ERRADO PELO ACRE, NESSE SENTIDO TEM
# UMA DIFERENÇA DE 478 TORNEZELEIRAS ELETRONICAS CONTABILIZADAS EM OUTROS REGIMES DIFERENTES DE
# "OUTROS" CONFORME NOTA TECNICA CNISP.
t1 <-
readRDS("data/data_rds/rel01_capacidade01.rds") |>
mutate(
qtd = case_when(
modalidade == "Domiciliar monitorado eletronicamente" & regime != "Outros" ~ 0,
TRUE ~ qtd
)
) |>
filter(
ciclo == vetor_filtro_ciclo
) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
filter(Masculino > 0 && Feminino > 0) |>
mutate(
Total = Masculino + Feminino
) |>
janitor::adorn_totals() |>
ungroup() |>
mutate_if(
is.numeric,
as.character
) |>
mutate(
Feminino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Feminino
),
Masculino = case_when(
modalidade == "Domiciliar monitorado eletronicamente" ~ "Não Aplicável",
TRUE ~ Masculino
)
) |>
filter(modalidade != "Total")
names(t1) <- c("Modalidade","Feminino","Masculino","Total")
formattable::formattable(
t1,
align = c("c","l","l","l"),
list(
#`UF` = color_tile("lightgrey","orange"),
`Modalidade` = color_tile("lightgrey","orange"),
#`Âmbito` = color_tile("lightblue","lightyellow"),
Feminino = color_tile("lightgrey","gray"),
Masculino = color_tile("lightgrey","gray"),
Total = color_tile("lightgrey","gray")
# area(col = c(`Feminino`)) ~ normalize_bar("#F6FF98", 0.2),
# area(col = c(`Masculino`)) ~ normalize_bar("#F6FF98", 0.2),
# area(col = c(`Total`)) ~ normalize_bar("lightblue", 0.2)
)) |>
as.datatable(
extensions = 'Buttons',
escape = FALSE,
#caption = "Tabela: Taxas de ocupação por unidade federativa, tipo de estabelecimento e regime.",
rownames = FALSE,
class='hover cell-border stripe',
filter = "top",
style = "bootstrap4",
options = list(
dom='Bfrtip',
buttons=c('copy', 'csv', 'excel', 'print', 'pdf'),
autoFill = TRUE,
colReorder = TRUE,
pageLength = 27,
lengthMenu = seq(10,max(nrow(t2))+10,10),
language = list(
info = 'Mostrando de _START_ para _END_ em um total de _TOTAL_ registros',
paginate = list(previous = 'Anterior', `next` = 'Seguinte'),
url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Portuguese-Brasil.json'
)
#pageLength = 5
)
)
t1 <-
readRDS("data/data_rds/rel02_populacao06.rds") |>
filter(ciclo == vetor_filtro_ciclo) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
mutate(
Total = Masculino + Feminino
) |>
arrange(desc(Total)) |>
adorn_totals()
library(tidyverse)
library(knitr)
library(plotly)
library(kableExtra)
library(DT)
library(gganimate)
library(formattable)
library(abjutils)
library(janitor)
library(ggforce) #UTILIZA FACET_WRAP_PAGINATE
cores <- c("#294661","#7F312F","#808080","#B8860B","#5E3B56","#5F9EA0","#808000","#A0522D",
"#F5DEB3","#FF9900","#8B008B","#5F6B6D","#FB8281","#F4D25A","#7F898A","#A4DDEE",
"#FDAB89","#B687AC","#28738A","#A78F8F","#168980","darkred","#0000FF","#00FFFF",
"#DAA520","#DEB887") #VETOR DE CORES PARA OS GRAFICOS
vetor_filtro_ciclo <- 13
vetor_filtro_semestre <- "segundo"
vetor_filtro_ano <- 2022
vetor_modalidade <- c("Custódia em unidade prisional",
"Domiciliar monitorado eletronicamente",
"Domiciliar não monitorado eletronicamente",
"Custódia em carceragens ou batalhões"
)
t1 <-
readRDS("data/data_rds/rel02_populacao06.rds") |>
filter(ciclo == vetor_filtro_ciclo) |>
group_by(modalidade,sexo) |>
summarise(
qtd = sum(qtd,na.rm = TRUE)
) |>
pivot_wider(
names_from = sexo,
values_from = qtd
) |>
mutate(
Total = Masculino + Feminino
) |>
arrange(desc(Total)) |>
adorn_totals()
names(t1) <- c("Modalidade","Feminino","Masculino","Total")
index_pop <- t1
formattable::formattable(
t1,
align = c("c","l","l","l"),
list(
#`Modalidade` = color_tile("lightgrey","orange"),
`Feminino` = color_bar("lightgrey"),
`Masculino`= color_bar("lightgrey"),
`Total`= color_bar("lightblue")
)) |>
as.datatable(
extensions = 'Buttons',
escape = FALSE,
#caption = "Quantidade de pessoas cumprindo penas estratificadas por tipo de custódia (modalidade) e sexo.",
rownames = FALSE,
class='display', #'hover cell-border stripe',
filter = "top",
style = "bootstrap4",
selection = c("multiple"), #c("multiple", "single", "none"),
options = list(
dom='Bfrtip',
buttons=c('copy', 'csv', 'excel', 'print', 'pdf'),
autoFill = TRUE,
colReorder = TRUE,
pageLength = 10,
lengthMenu = seq(10,max(nrow(t2))+10,10),
autoWidth = TRUE,
initComplete = JS(
"function(settings, json) {",
#"$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});", - #CONFIGURACAO DO CABECALHO
"$('body').css({'font-family': 'Calibri'});",
"}"
),
language = list(
info = 'Mostrando de _START_ para _END_ em um total de _TOTAL_ registros',
paginate = list(previous = 'Anterior', `next` = 'Seguinte'),
url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Portuguese-Brasil.json'
)
)
)
